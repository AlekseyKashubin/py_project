/** Shopify CDN: Minification failed

Line 10:0 Transforming const to the configured target environment ("es5") is not supported yet
Line 11:2 Transforming const to the configured target environment ("es5") is not supported yet
Line 39:2 Transforming const to the configured target environment ("es5") is not supported yet
Line 40:4 Transforming const to the configured target environment ("es5") is not supported yet
Line 61:2 Transforming const to the configured target environment ("es5") is not supported yet

**/
const loadZendesk = () => {
  const zopimConfig = () => {
    if (Shopify.country !== 'CA') {
      // USA
      $zopim.livechat.departments.setLabel('Select a Department');
      $zopim.livechat.departments.filter('Sales', 'Customer Service', 'Technical Support');
      $zopim.livechat.concierge.setTitle('Whole Latte Love');
      $zopim.livechat.concierge.setName('Whole Latte Love Support');
      $zopim.livechat.window.setTitle('Whole Latte Love Support');
      $zopim.livechat.prechatForm.setGreetings("Need help finding something? We're here to assist. Lets start with a few questions...");
      $zopim.livechat.badge.setText('Need Help? Ask us!');
      $zopim.livechat.window.setTitle('Whole Latte Love Chat');
      $zopim.livechat.badge.hide();
      $zopim.livechat.theme.reload();
    } else {
      // CANADA
      $zopim.livechat.departments.setLabel('Select a Department');
      $zopim.livechat.departments.filter('Sales (Canada)', 'Customer Service (Canada)', 'Technical Support (Canada)');
      $zopim.livechat.concierge.setTitle('Whole Latte Love');
      $zopim.livechat.concierge.setName('Whole Latte Love Support');
      $zopim.livechat.window.setTitle('Whole Latte Love Support');
      $zopim.livechat.prechatForm.setGreetings("Need help finding something? We're here to assist. Lets start with a few questions...");
      $zopim.livechat.badge.setText('Need Help? Ask us!');
      $zopim.livechat.window.setTitle('Whole Latte Love Chat');
      $zopim.livechat.badge.hide();
      $zopim.livechat.theme.reload();
    }
  };

  const loadZendeskChat = (callback) => {
    const zendeskScript = document.getElementById('ze-snippet');

    if (!zendeskScript) {
      var zdscript = document.createElement('script');
      zdscript.setAttribute('id', 'ze-snippet');
      zdscript.src = 'https://static.zdassets.com/ekr/snippet.js?key=44a375ad-4a04-4113-8214-0d69a26c35f7';
      document.getElementsByTagName('body')[0].appendChild(zdscript);
    }

    window.zdonload = setInterval(
      function () {
        if (typeof zE !== 'undefined' && typeof zE.activate !== 'undefined') {
          clearInterval(window.zdonload);
          callback();
        }
      },
      50,
      null
    );
  };

  const initialLoadZendesk = () => {
    localStorage.setItem('ff_zd_hasOpened', true);
    loadZendeskChat(() => {
      zE(() => {
        //Zopim API
        $zopim(() => zopimConfig());
        //End Zopim API
      });
    });

    document.removeEventListener('scroll', initialLoadZendesk);
    document.removeEventListener('mousedown', initialLoadZendesk);
    document.removeEventListener('mousemove', initialLoadZendesk);
    document.removeEventListener('touchstart', initialLoadZendesk);
    document.removeEventListener('keydown', initialLoadZendesk);
  };

  if (localStorage.getItem('ff_zd_hasOpened')) {
    loadZendeskChat(() => {
      zE(() => {
        //Zopim API
        $zopim(() => zopimConfig());
        //End Zopim API
      });
    });
  } else {
    // Initial Load of Zendesk before flag is set in localStorage for subsequent requests
    document.addEventListener('scroll', initialLoadZendesk);
    document.addEventListener('mousedown', initialLoadZendesk);
    document.addEventListener('mousemove', initialLoadZendesk);
    document.addEventListener('touchstart', initialLoadZendesk);
    document.addEventListener('keydown', initialLoadZendesk);
  }
};

loadZendesk();
